function startHeader(){var a=ThreeUtils.scenePresets("onlyShader");a.init.material.shader.fragment="header";var b=ThreeUtils.createScene("header-canvas",a);b.start()}var Utils={isVisible:function(a){var b=$(document).scrollTop(),c=b+$(window).height(),d=$(a).offset().top,e=d+$(a).height();return c>d&&e>b}};$(document).ready(function(){$.material.init(),$("#navbar").affix({offset:{top:$("#header-wrapper").height()}}),$('a[href^="#"]').on("click",function(a){a.preventDefault();var b=this.hash,c=parseInt($(b).attr("data-top"));c||(c=0),$("html, body").animate({scrollTop:$(this.hash).offset().top-c},800,function(){window.location.hash=b})});var a=$("#navbar"),b=a.outerHeight()+15,c=a.find("a"),d=c.map(function(){var a=$(this).attr("href");return"#"===a.charAt(0)&&(a=$(a),a.length)?a:void 0});$(".current-year").html((new Date).getFullYear()),$(window).scroll(function(){var a=$(this).scrollTop()+b,e=d.map(function(){return $(this).offset().top<a?this:void 0});e=e[e.length-1];var f=e&&e.length?e[0].id:"";c.parent().removeClass("active").end().filter('[href="#'+f+'"]').parent().addClass("active")})}),$(document).ready(function(){$.each($(".linkolor"),function(a,b){var c=$(b),d=c.attr("data-gray"),e=c.attr("data-color"),f=(c.attr("data-url"),c.attr("data-bg")),g=c.attr("data-class");$graydiv=$('<div class="linkolor-gray linkolor-link"></div>').width(c.width()).height(c.height()).css("background-image",'url("'+d+'")').css("background-color",f),$colordiv=$('<div class="linkolor-color linkolor-link"></div>').width(c.width()).height(c.height()).css("background-image",'url("'+e+'")').css("background-color",f),g&&($graydiv.addClass(g),$colordiv.addClass(g)),c.append($graydiv),c.append($colordiv)}),$(".linkolor").mouseenter(function(a){a.stopPropagation();var b=$(this),c=b.children(".linkolor-gray"),d=b.children(".linkolor-color");c.stop().fadeOut(200),d.stop().fadeIn(200)}),$(".linkolor").mouseleave(function(a){a.stopPropagation();var b=$(this),c=b.children(".linkolor-gray"),d=b.children(".linkolor-color");c.stop().fadeIn(200),d.stop().fadeOut(200)}),$(".linkolor").click(function(){var a=$(this),b=a.attr("data-url"),c=a.attr("data-target");b&&(c&&"_blank"===c?window.open(b):window.location=b)})}),$(document).ready(function(){$(".normalink").click(function(){var a=$(this),b=a.attr("data-url"),c=a.attr("data-target");b&&(c&&"_blank"===c?window.open(b):window.location=b)})});var ThreeUtils={createScene:function(a,b){var c={};if(c.canInit=!0,c.startPending=!1,b||(b={}),c.settings=$.extend(!0,{},ThreeUtils.scenePresets("normal3DScene"),b),console.log(c.settings),c.canvas=$("#"+a),0==c.canvas.length)return console.error("You must provide a valid canvasID"),null;var d=c.canvas.width(),e=c.canvas.height();switch(c.rendering=Utils.isVisible(c.canvas),c.scene=new THREE.Scene,c.settings.camera.type){case"PerspectiveCamera":c.camera=new THREE.PerspectiveCamera(75,d/e,.1,1e3);break;case"OrthographicCamera":c.camera=new THREE.OrthographicCamera(-1,1,-1,1,1,1e3);break;default:return console.error("camera.type not recognised: "+c.settings.camera.type),null}c.renderer=new THREE.WebGLRenderer({canvas:c.canvas[0]}),c.renderer.setSize(d,e),c.rt1=new THREE.WebGLRenderTarget(d,e,{minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat}),c.rt2=new THREE.WebGLRenderTarget(d,e,{minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat});var f=c.settings.camera.position,g=c.settings.camera.up,h=c.settings.camera.look;switch(c.camera.position.set(f.x,f.y,f.z),c.camera.up.set(g.x,g.y,g.z),c.camera.lookAt(h.x,h.y,h.z),c.settings.camera.controls){case"OrbitControls":c.controls=new THREE.OrbitControls(c.camera,c.canvas[0]);break;case"None":c.controls=null;break;default:return console.error("camera.controls not recognised: "+c.settings.camera.controls),null}var d=c.canvas.width(),e=c.canvas.height();switch(c.settings.render.mode){case"Loop":c.render=function(){if(requestAnimationFrame(c.render),c.rendering){c.update(),c.renderer.render(c.scene,c.camera),c.renderer.render(c.scene,c.camera,c.rt1,!1);var a=c.rt2;c.rt2=c.rt1,c.rt1=a,c.uniforms.iBackbuffer.value=this.rt2}},$(window).scroll(function(a){Utils.isVisible(c.canvas)?c.rendering=!0:c.rendering=!1}),$(c.canvas).resize(function(a){c.camera&&(c.camera.aspect=d/c.canvas.window.innerHeight,c.camera.updateProjectionMatrix()),c.renderer.setSize(d,e),c.rt1.setSize(d,e),c.rt2.setSize(d,e)});break;case"Once":c.render=function(){c.update(),c.renderer.render(c.scene,c.camera)};break;case"OnChange":return console.error("render.mode not yet implemented: OnChange"),null;default:return console.error("render.mode not recognised: "+c.settings.render.mode),null}if(c.start=function(){c.canInit?(c.init(),c.clock=new THREE.Clock,c.render()):c.startPending=!0},"Shader"==c.settings.init.material.type){c.canInit=!1,c.shaderLoaded=function(a,b){c.settings.init.material.shader.vertex=a,c.settings.init.material.shader.fragment=b,c.canInit=!0,c.startPending&&c.start()};var i=ThreeUtils.createShaderLoader();i.loadShaders(c.settings.init.material.shader.vertex,c.settings.init.material.shader.fragment,c.shaderLoaded)}switch(c.init=function(){var a=!1,b=!1;switch(c.settings.init.object){case"Cube":var a=new THREE.BoxGeometry(1,1,1);break;case"Plane":var a=new THREE.PlaneBufferGeometry(2,2);break;case"None":break;default:return console.error("init.object not recognised: "+c.settings.init.object),null}switch(c.settings.init.material.type){case"Color":b=new THREE.MeshBasicMaterial({color:c.settings.init.material.color});break;case"Shader":c.uniforms={},"Default"==c.settings.update&&(c.uniforms.iResolution={type:"v2",value:new THREE.Vector2(c.canvas.width(),c.canvas.height())},c.uniforms.iTime={type:"f",value:0},c.uniforms.iTimeDelta={type:"f",value:0},c.uniforms.iFrame={type:"i",value:0},c.uniforms.iMouse={type:"v4",value:new THREE.Vector4(.5*c.canvas.width(),.5*c.canvas.height(),0,0)},c.uniforms.iScroll={type:"f",value:0},c.uniforms.iBackbuffer={type:"t",value:c.rt1});var b=new THREE.ShaderMaterial({uniforms:c.uniforms,vertexShader:c.settings.init.material.shader.vertex,fragmentShader:c.settings.init.material.shader.fragment});break;case"None":break;default:return console.error("init.material not recognised: "+c.settings.init.material),null}a&&b&&c.scene.add(new THREE.Mesh(a,b))},c.settings.update){case"Default":c.update=function(){var a=c.clock.getDelta();c.uniforms.iResolution.value=new THREE.Vector2(c.canvas.width(),c.canvas.height()),c.uniforms.iTime.value+=a,c.uniforms.iTimeDelta.value=a,c.uniforms.iFrame.value+=1,c.uniforms.iScroll.value=-c.canvas[0].getBoundingClientRect().y,c.uniforms.iBackbuffer.value=c.rt1},$(document).mousemove(function(a){var b=c.canvas[0].getClientRects()[0];c.uniforms.iMouse.value.x=a.clientX-b.x,c.uniforms.iMouse.value.y=b.height-(a.clientY-b.y)}),$(document).mousedown(function(a){c.uniforms.iMouse.value.z=1}),$(document).mouseup(function(a){c.uniforms.iMouse.value.z=0});break;case"None":c.update=function(){};break;default:return console.error("update not recognised: "+c.settings.update),null}return c},createShaderLoader:function(){var a={};return a.vertexShader=!1,a.fragmentShader=!1,a.processVertex=function(b,c){a.vertexShader=b.responseText,a.fragmentShader&&a.callback(a.vertexShader,a.fragmentShader)},a.processFragment=function(b,c){a.fragmentShader=b.responseText,a.vertexShader&&a.callback(a.vertexShader,a.fragmentShader)},a.loadShaders=function(b,c,d){a.callback=d,$.ajax({url:"/shaders/"+b+".vertex.glsl",dataType:"text",complete:a.processVertex}),$.ajax({url:"/shaders/"+c+".fragment.glsl",dataType:"text",complete:a.processFragment})},a},scenePresets:function(a){return presets={normal3DScene:{render:{mode:"Loop"},camera:{type:"PerspectiveCamera",position:new THREE.Vector3(0,0,5),look:new THREE.Vector3(0,0,0),up:new THREE.Vector3(0,1,0),controls:"OrbitControls"},init:{object:"Cube",material:{type:"Color",color:16711680}},update:"None"},onlyShader:{init:{object:"Plane",material:{type:"Shader",shader:{vertex:"default",fragment:"default"}}},update:"Default"}},$.extend(!0,{},presets[a])}};